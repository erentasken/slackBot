@page
@model botApp.Pages.gptTryingModel

<form method="post">
    <input type="text" name="prompt" placeholder="Enter your prompt" />
    <button type="submit" id = "submitButton">Submit</button>
</form>

<h3>Completion Result:</h3>
<p id="textArea"></p>

<script>
    const button = document.getElementById('submitButton');
    button.addEventListener('click', async function(event) {
        event.preventDefault();
        const APIkey = "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";
        const endpoint = "https://api.openai.com/v1/completions";
        const prompt = document.querySelector('input[name="prompt"]').value; // Get the prompt value from the input tag
        const model = "text-davinci-003"; // Note: you can change this to "gpt-3.5-turbo" if you prefer that model
        const maxTokens = 150;

        const headers = {
            "Authorization": `Bearer ${APIkey}`,
            "Content-Type": "application/json"
        };

        const body = JSON.stringify({
            model,
            prompt,
            max_tokens: maxTokens
        });

        try {
            const response = await fetch(endpoint, {
                method: "POST",
                headers,
                body
            });

            const responseData = await response.json();
            if (responseData && responseData.choices && responseData.choices.length > 0) {
                console.log(responseData.choices[0].text);
                const resultText = responseData.choices[0].text;
                const resultElement = document.getElementById("textArea");
                resultElement.innerText = resultText;
            } else {
                console.error("Invalid API response:", responseData);
            }
        } catch (error) {
            console.error("Error calling OpenAI API:", error);
        }
    } ); 

</script>
